<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML><HEAD>
<TITLE>McStas: Sample_nxs Component</TITLE>
<LINK REV="made" HREF="mailto:peter.willendrup@risoe.dk">
</HEAD>

<BODY>

<P ALIGN=CENTER>
 [ <A href="#id">Identification</A>
 | <A href="#desc">Description</A>
 | <A href="#ipar">Input parameters</A>
 | <A href="#opar">Output parameters</A>
 | <A href="#links">Links</A> ]
</P>

<H1>The <CODE>Sample_nxs</CODE> Component</H1>

General powder/polycrystalline sample with neutron-matter interaction based
   on neutron cross section calculations of a unit cell


<H2><A NAME=id></A>Identification</H2>

<UL>
  <LI> <B>Author:</B> Mirko Boin</B>
  <LI> <B>Origin:</B> Helmholtz-Zentrum Berlin fuer Materialien und Energie (Germany)</B>
  <LI> <B>Date:</B> Oct 2014</B>
  <LI> <B>Version:</B> 1.2</B>
</UL>
<H2><A NAME=desc></A>Description</H2>

<PRE>
Features:
     - coherent and incoherent scattering, absorption and transmission
     - multiple scattering 
     - wavelength-dependent neutron cross section calculation
     - unit cell definition (via input file)
     - focussing option for scattered neutrons (via d_phi)
     - strain gradient simulation for axial symmetric samples (...to be extended)

Geometry is a powder filled cylinder or a box defined by radius or xwidth, 
yheight, zthick respectively. The component handles coherent and incoherent
scattering (also multiple scattering), absorption and transmission. Hence, it
is suitable for diffraction (scattering) and imaging (transmission) instruments
at the same time. In order to improve the neutron statistics at the detector
these individual features can be enabled/disabled using TransOnly, IncohScat,
MultiScat. 
For example, if scattering shall not be monitored (e.g. imaging), then TransOnly
can be set to 1 to let the component calculate the neutron transmission through
the sample only. Likewise, incoherent scattering can be switched on and off.

The decision of whether a neuron shall be scattered, absorbed or transmitted is
based on the wavelength-dependent neutron cross sections (nxs), i.e. the neutron
velocity is used here. These cross sections represent the individual scattering 
and absorption probabilities for each individual neutron. However, the calculation
of neutron cross sections depends on the material defined for this sample component.
Therefore, several input parameters such as the crystal structure and the atoms
involved (isotope mass, coherent scattering length, ...). This information is
provided by an input file with the following format:

<table border="1"><tr align="center"><td><B>Al.nxs</B></td></tr><tr><td><B># define the unit cell parameters:<BR>
#   space_group                      - the space group number or Hermann or Hall symbol [string]<BR>
#   lattice_a, ...b, ...c            - the lattice spacings a,b,c [angstrom]<BR>
#   lattice_alpha, ...beta, ...gamma - the lattice angles alpha,beta,gamma [degree]<BR>
#   debye_temp                       - the Debye temperature [K]<BR>
<BR>
space_group    = -F 4 2 3 # space group number is also allowed (= 225)<BR>
lattice_a = 4.049<BR>
lattice_b = 4.049<BR>
lattice_c = 4.049<BR>
lattice_alpha = 90<BR>
lattice_beta = 90<BR>
lattice_gamma = 90<BR>
debye_temp = 429.0<BR>
<BR>
# add atoms to the unit cell:<BR>
# notation is "atom_number = name b_coh sigma_inc sigma_abs_2200 molar_mass x y z"<BR>
#   name           - labels the current atom/isotope  [string]<BR>
#   b_coh          - the coherent scattering length [fm]<BR>
#   sigma_inc      - the incoherent scattering cross section [barns]<BR>
#   sigma_abs_2200 - the absorption cross sect. at 2200 m/s [barns]<BR>
#   molar_mass     - the Molar mass [g/mol]<BR>
#   debye_temp     - the Debye temperature [K]<BR>
#   x y z          - the Wyckoff postion of the atom inside the unit cell<BR>
<BR>
[atoms]<BR>
add_atom = Al 3.449 0.008 0.23 26.98 0.0 0.0 0.0<BR>
</B></td></tr></table>
The above example defines a pure (fcc) aluminium. Other example files are provided.
Alternatively, a fallback mechanism exists to simulate an alpha-Fe (bcc) sample
if an input file is missing. But have a look for warning messages during simulation to
make sure you are not running the fallback alpha-Fe simulation accidently! 

CHANGELOG:
   v1.0 - first official release with McStas 2.0
   v1.1 - enabled strain distribution
   v1.2 - use updated libnxs (global Debye temp -> parameter files changed)
        - corrected sigma incoherent  
        - updated towards McStas 2.1 conventions

For details, please contact the author and visit the nxs website and/or the repository.
NXS Website: <a href="http://www.helmholtz-berlin.de/people/boin/nxs_en.html">http://www.helmholtz-berlin.de/people/boin/nxs_en.html</a>
NXS Repository: <a href="http://bitbucket.org/mirkoboin/nxs">http://bitbucket.org/mirkoboin/nxs</a>


</PRE>
WARNING: <B>This is a contributed Component.</B>

<H2><A NAME=ipar></A>Input parameters</H2>
Parameters in <B>boldface</B> are required;
the others are optional.
<TABLE BORDER=1>
<TR><TH>Name</TH>  <TH>Unit</TH>  <TH>Description</TH> <TH>Default</TH></TR>
<TR> <TD>TransOnly</TD>
     <TD>-</TD>
     <TD>enable/disable (=1/=0) the transmission only option</TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>IncohScat</TD>
     <TD>-</TD>
     <TD>enable/disable (=1/=0) incoherent scattering</TD>
<TD ALIGN=RIGHT>1</TD> </TR>
<TR> <TD>MultiScat</TD>
     <TD>-</TD>
     <TD>enable/disable (=1/=0) multiple scattering</TD>
<TD ALIGN=RIGHT>1 </TD> </TR>
<TR> <TD>xwidth</TD>
     <TD>m</TD>
     <TD>horizontal dimension of sample, as a width </TD>
<TD ALIGN=RIGHT>0.05</TD> </TR>
<TR> <TD>yheight</TD>
     <TD>m</TD>
     <TD>vertical dimension of sample, as a height </TD>
<TD ALIGN=RIGHT>0.05</TD> </TR>
<TR> <TD>zthick</TD>
     <TD>m</TD>
     <TD>thickness of sample </TD>
<TD ALIGN=RIGHT>0.05</TD> </TR>
<TR> <TD>radius</TD>
     <TD>m</TD>
     <TD>radius of sample in (x,z) plane </TD>
<TD ALIGN=RIGHT>0.0</TD> </TR>
<TR> <TD>nxsFileName</TD>
     <TD>-</TD>
     <TD>filename of the unit cell definition</TD>
<TD ALIGN=RIGHT>""</TD> </TR>
<TR> <TD>max_hkl</TD>
     <TD>-</TD>
     <TD>maximum (hkl) indices to consider for the nxs calculation, e.g. max_hkl=3 means (hkl)=333</TD>
<TD ALIGN=RIGHT>8</TD> </TR>
<TR> <TD>d_phi</TD>
     <TD>deg,0-180</TD>
     <TD>=0:     Angle corresponding to the vertical angular range
to focus to, e.g. detector height. 0 for no focusing </TD>
<TD ALIGN=RIGHT>0</TD> </TR>
<TR> <TD>strainFileName</TD>
     <TD>-</TD>
     <TD>filename for simulating strain gradients</TD>
<TD ALIGN=RIGHT>"" </TD> </TR>
</TABLE>


<H2><A NAME=opar></A>Output parameters</H2>
<TABLE BORDER=1>
<TR><TH>Name</TH>  <TH>Unit</TH>  <TH>Description</TH> <TH>Default</TH></TR>
<TR> <TD><B>isrect</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>intersect</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>nxs_init_success</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>p_transmit</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>xsect_total</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>xsect_coherent</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>xsect_incoherent</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>xsect_absorption</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>lambda</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>velocity</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>fullpath</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>t1</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>t2</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>temperature</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>uc</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>A</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>mu_factor</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>sd</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
<TR> <TD><B>V2L</B></TD>
     <TD></TD> <TD></TD>
<TD ALIGN=RIGHT>&nbsp;</TD> </TR>
</TABLE>


<H2><A NAME=links></A>Links</H2>

<UL>
  <LI> <A HREF="Sample_nxs.comp">Source code</A> for <CODE>Sample_nxs.comp</CODE>.
</UL>
<HR>
<P ALIGN=CENTER>
 [ <A href="#id">Identification</A>
 | <A href="#desc">Description</A>
 | <A href="#ipar">Input parameters</A>
 | <A href="#opar">Output parameters</A>
 | <A href="#links">Links</A> ]
</P>

<ADDRESS>
Generated automatically by McDoc, Peter Willendrup
&lt;<A HREF="mailto:peter.willendrup@risoe.dk">peter.willendrup@risoe.dk</A>&gt; /
Thu Jun 16 08:51:07 2016</ADDRESS>
</BODY></HTML>
